{"version":3,"file":"app.js","sources":["../src/util/object-assign.js","../node_modules/preact/dist/preact.mjs","../src/util/pure-component.js","../src/app/components/ImageSelection.jsx","../src/app/components/Canvas.jsx","../src/app/components/Filters.jsx","../node_modules/symbol-observable/es/index.js","../node_modules/symbol-observable/es/ponyfill.js","../node_modules/redux/es/redux.js","../src/util/image-data.js","../src/app/store/reducers/image-change.js","../src/util/worker.js","../src/app/store/constants.js","../src/app/store/main.js","../src/util/filters.js","../src/app/store/reducers/middleware.js","../src/app/components/Application.jsx","../src/app/main.js"],"sourcesContent":["/**\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign\n *  */\nif (typeof Object.assign != 'function') {\n    // Must be writable: true, enumerable: false, configurable: true\n    Object.defineProperty(Object, 'assign', {\n        value: function assign(target, varArgs) {\n            // .length of function is 2\n            'use strict';\n            if (target == null) {\n                // TypeError if undefined or null\n                throw new TypeError(\n                    'Cannot convert undefined or null to object'\n                );\n            }\n\n            var to = Object(target);\n\n            for (var index = 1; index < arguments.length; index++) {\n                var nextSource = arguments[index];\n\n                if (nextSource != null) {\n                    // Skip over if undefined or null\n                    for (var nextKey in nextSource) {\n                        // Avoid bugs when hasOwnProperty is shadowed\n                        if (\n                            Object.prototype.hasOwnProperty.call(\n                                nextSource,\n                                nextKey\n                            )\n                        ) {\n                            to[nextKey] = nextSource[nextKey];\n                        }\n                    }\n                }\n            }\n            return to;\n        },\n        writable: true,\n        configurable: true,\n    });\n}\n","var l,n,u,t,i={},r=[],f=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i;function e(l,n){for(var u in n)l[u]=n[u];return l}function o(l,n,u){var t,i,r,f,e=arguments;if(null==n&&(n={}),arguments.length>3)for(u=[u],t=3;t<arguments.length;t++)u.push(e[t]);if(null!=u&&(n.children=u),null!=l&&null!=l.defaultProps)for(i in l.defaultProps)void 0===n[i]&&(n[i]=l.defaultProps[i]);return(r=n.ref)&&delete n.ref,(f=n.key)&&delete n.key,c(l,n,null,f,r)}function c(n,u,t,i,r){var f={type:n,props:u,text:t,key:i,ref:r,__k:null,__e:null,l:null,__c:null};return l.vnode&&l.vnode(f),f}function s(){return{}}function a(){}function h(l){return null==l||\"boolean\"==typeof l?null:\"string\"==typeof l||\"number\"==typeof l?c(null,null,l,null,null):Array.isArray(l)?o(a,null,l):null!=l.__e?c(l.type,l.props,l.text,l.key,null):l}function v(l,n){this.props=l,this.context=n}function y(t){!t.__d&&(t.__d=!0)&&1===n.push(t)&&(l.debounceRendering||u)(p)}function p(){for(var l;l=n.pop();)l.__d&&l.forceUpdate()}function d(l,n,u,t,f,e,o,c){var s,v,y,p,d,b,g,w,k,x,A=m(n),C=null==u||u==i?r:m(u),N=C.length,T=C.length?C[0]&&C[0].__e:null;if(null!=e)for(v=0;v<e.length;v++)if(null!=e[v]){T=e[v];break}for(v=0;v<A.length;v++){if(s=A[v]=h(A[v]),b=d=null,null!=(p=C[v])&&(null==s.key&&null==p.key?s.type===p.type:s.key===p.key))d=v;else for(y=0;y<N;y++)if(null!=(p=C[y])&&(null==s.key&&null==p.key?s.type===p.type:s.key===p.key)){d=y;break}if(null!=d&&(b=C[d],C[d]=null),w=null!=T&&T.nextSibling,g=_(null==b?null:b.__e,l,s,b,t,f,e,o,c),null!=s&&null!=g){if(x=document.activeElement,null!=s.l)g=s.l;else if(e==b||g!=T||null==g.parentNode)l:if(null==T||T.parentNode!==l)l.appendChild(g);else{for(k=T,y=0;(k=k.nextSibling)&&y++<N/2;)if(k===g)break l;l.insertBefore(g,T)}x!==document.activeElement&&x.focus(),T=null!=g?g.nextSibling:w}}if(null!=e&&n.type!==a)for(v=e.length;v--;)null!=e[v]&&e[v].remove();for(v=C.length;v--;)null!=C[v]&&P(C[v],c)}function m(l){return null==l.__k&&b(l.props.children,l.__k=[]),l.__k}function b(l,n){if(null==n&&(n=[]),null==l||\"boolean\"==typeof l);else if(Array.isArray(l))for(var u=0;u<l.length;u++)b(l[u],n);else n.push(h(l));return n}function g(l,n,u,t){var i,r;for(i in n)\"children\"===i||\"key\"===i||u&&u[i]==n[i]||w(l,i,n[i],u[i],t);for(r in u)\"children\"===r||\"key\"===r||n&&r in n||w(l,r,null,u[r],t)}function w(l,n,u,t,i){var r,e,o,c,s,a;if(\"class\"!==n&&\"className\"!==n||(n=i?\"class\":\"className\"),\"style\"===n){if(e=l.style,\"string\"==typeof u)e.cssText=u;else for(o in\"string\"==typeof t&&(e.cssText=\"\"),t)null!=u&&o in u||e.setProperty(o,\"\");for(c in u)r=u[c],null!=t&&r===t[c]||e.setProperty(c.replace(/-?(?=[A-Z])/g,\"-\"),\"number\"==typeof r&&!1===f.test(c)?r+\"px\":r)}else\"dangerouslySetInnerHTML\"===n?u&&t&&u.__html==t.__html||(l.innerHTML=u&&u.__html||\"\"):\"o\"===n[0]&&\"n\"===n[1]?(s=n!==(n=n.replace(/Capture$/,\"\")),a=n.toLowerCase(),n=(a in l?a:n).substring(2),u?t||l.addEventListener(n,k,s):l.removeEventListener(n,k,s),(l.n||(l.n={}))[n]=u):\"list\"!==n&&!i&&n in l?l[n]=null==u?\"\":u:null==u||!1===u?l.removeAttribute(n):\"function\"!=typeof u&&l.setAttribute(n,u)}function k(n){return this.n[n.type](l.event?l.event(n):n)}function _(n,u,t,r,f,o,c,s,y){var p,m,b,g,w,k,x,$,j,z,D,H,I,L;if(null==r||null==t||r.type!==t.type){if(null!=r&&P(r,y),null==t)return null;n=null,r=i}l.diff&&l.diff(t),b=!1,x=t.type;try{l:if(r.type===a||x===a)d(u,t,r,f,o,c,s,p),t.__k.length&&(n=t.__k[0].__e,t.l=t.__k[t.__k.length-1].__e);else if(\"function\"==typeof x){if(z=(j=x.contextType)&&f[j.__c],D=null!=j?z?z.props.value:j.__p:f,r.__c?$=(p=t.__c=r.__c).__p:(b=!0,x.prototype&&x.prototype.render?t.__c=p=new x(t.props,D):(t.__c=p=new v(t.props,D),p.constructor=x,p.render=N),p.__a=y,z&&z.sub(p),p.props=t.props,p.state||(p.state={}),p.context=D,p.__n=f,p.__d=!0,p.__h=[]),p.__v=t,H=p.__s||p.state,null!=x.getDerivedStateFromProps&&(w=e({},p.state),H===p.state&&(H=e({},H)),e(H,x.getDerivedStateFromProps(t.props,H))),b)null==x.getDerivedStateFromProps&&null!=p.componentWillMount&&p.componentWillMount(),null!=p.componentDidMount&&s.push(p);else{if(!p.u&&null!=p.shouldComponentUpdate&&!1===p.shouldComponentUpdate(t.props,H,D)){p.__d=!1;break l}null==x.getDerivedStateFromProps&&null==p.u&&null!=p.componentWillReceiveProps&&p.componentWillReceiveProps(t.props,D),null!=p.componentWillUpdate&&p.componentWillUpdate(t.props,H,D)}g=p.props,w||(w=p.state),k=p.context=D,p.props=t.props,p.state=H,l.render&&l.render(t),I=p.__t,L=p.__t=h(p.render(p.props,p.state,p.context)),p.__d=!1,null!=p.getChildContext&&(f=e(e({},f),p.getChildContext())),b||null==p.getSnapshotBeforeUpdate||(k=p.getSnapshotBeforeUpdate(g,w)),p.base=n=_(n,u,L,I,f,o,c,s,p),null!=L&&(t.l=L.l),p.t=u,t.ref&&C(t.ref,p,y)}else n=A(n,t,r,f,o,c,s,y),t.ref&&r.ref!==t.ref&&C(t.ref,n,y);if(t.__e=n,null!=p){for(;m=p.__h.pop();)m();b||null==g||null==p.componentDidUpdate||p.componentDidUpdate(g,w,k)}$&&(p.__p=null),l.diffed&&l.diffed(t)}catch(l){T(l,y)}return n}function x(n,u){for(var t;t=n.pop();)try{t.componentDidMount()}catch(l){T(l,t.__a)}l.commit&&l.commit(u)}function A(l,n,u,t,i,f,e,o){var c,s,a,h,v=l;if(i=i?\"foreignObject\"!==n.type:\"svg\"===n.type,null==l&&null!=f)for(c=0;c<f.length;c++)if(null!=(s=f[c])&&(null===n.type?3===s.nodeType:s.localName===n.type)){l=s,f[c]=null;break}if(null==l&&(l=null===n.type?document.createTextNode(n.text):i?document.createElementNS(\"http://www.w3.org/2000/svg\",n.type):document.createElement(n.type),f=null),n.__e=l,null===n.type)null!==v&&l!==v||n.text===u.text||(l.data=n.text);else{if(null!=f&&null!=l.childNodes&&(f=r.slice.call(l.childNodes)),n!==u){if(null==(a=u.props)&&(a={},null!=f))for(h=0;h<l.attributes.length;h++)a[l.attributes[h].name]=l.attributes[h].value;g(l,n.props,a,i)}d(l,n,u,t,i,f,e,o)}return l}function C(l,n,u){try{\"function\"==typeof l?l(n):l.current=n}catch(l){T(l,u)}}function P(n,u){var t,i;if(l.unmount&&l.unmount(n),(t=n.ref)&&C(t,null,u),null!=(t=n.__e)&&t.remove(),n.__e=n.l=null,null!=(t=n.__c)){if(t.componentWillUnmount)try{t.componentWillUnmount()}catch(l){T(l,u)}t.base=t.t=null,(t=t.__t)&&P(t,u)}else if(t=n.__k)for(i=0;i<t.length;i++)P(t[i],u)}function N(l,n,u){return this.constructor(l,u)}function T(l,n){for(;n;n=n.__a)if(!n.__p)try{if(null!=n.constructor.getDerivedStateFromError)n.setState(n.constructor.getDerivedStateFromError(l));else{if(null==n.componentDidCatch)continue;n.componentDidCatch(l)}return y(n.__p=n)}catch(n){l=n}throw l}function $(l,n){var u,t=n.__t;l=o(a,null,[l]),u=[],d(n,n.__t=l,t,i,void 0!==n.ownerSVGElement,t?null:r.slice.call(n.childNodes),u,l),x(u,l)}function j(l,n){n.__t=null,$(l,n)}function z(l,n){return n=e(e({},l.props),n),arguments.length>2&&(n.children=r.slice.call(arguments,2)),c(l.type,n,null,n.key||l.key,n.ref||l.ref)}function D(l){var n,u=\"__cC\"+t++,i={__c:u,__p:l};function r(l,n){return l.children(n)}return r.contextType=i,i.Consumer=r,(n={})[u]=null,i.Provider=function(l){var t,i;return this.getChildContext||(i=[],(t=this).getChildContext=function(){return n[u]=t,n},t.componentDidUpdate=function(){var l=t.props.value;i.map(function(n){return l!==n.context&&(n.context=l,y(n))})},t.sub=function(l){i.push(l);var n=l.componentWillUnmount;l.componentWillUnmount=function(){i.splice(i.indexOf(l),1),n&&n()}}),l.children},i}l={},v.prototype.setState=function(l,n){var u=this.__s!==this.state&&this.__s||(this.__s=e({},this.state));this.i=e({},u),(\"function\"!=typeof l||(l=l(u,this.props)))&&e(u,l),null!=l&&(null!=n&&this.__h.push(n),this.u=!1,y(this))},v.prototype.forceUpdate=function(l){var n,u=this.__v,t=this.__v.__e,i=this.t;null!=i&&(null==this.u&&(this.u=!0),null!=(t=_(t,i,u,u,this.__n,void 0!==i.ownerSVGElement,null,n=[],this.__a))&&t.parentNode!==i&&i.appendChild(t),x(n,u),this.u=null),null!=l&&l()},v.prototype.render=a,n=[],u=\"function\"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,t=0;export{$ as render,j as hydrate,o as createElement,o as h,a as Fragment,s as createRef,v as Component,z as cloneElement,D as createContext,b as toChildArray,l as options};\n//# sourceMappingURL=preact.mjs.map\n","import { Component } from 'preact';\n\nexport function pure(target) {\n    if (target.prototype && target.prototype.render) {\n        target.prototype.shouldComponentUpdate = shouldComponentUpdate;\n    } else {\n        return target.__scuWrap || (target.__scuWrap = wrap(target));\n    }\n}\n\nfunction wrap(fn) {\n    class Wrap extends Wrapper {}\n    Wrap.prototype.renderChild = fn;\n    return Wrap;\n}\n\nclass Wrapper extends Component {\n    shouldComponentUpdate(props) {\n        return shallowDiffers(props, this.props);\n    }\n    render(props, state, context) {\n        return this.renderChild(props, context);\n    }\n}\n\nexport function shouldComponentUpdate(props, state) {\n    return (\n        shallowDiffers(props, this.props) || shallowDiffers(state, this.state)\n    );\n}\n\nexport function shallowDiffers(a, b) {\n    for (let key in a) if (a[key] !== b[key]) return true;\n    for (let key in b) if (!(key in a)) return true;\n    return false;\n}\n","import { h } from 'preact';\nimport { pure } from '../../util/pure-component';\nimport './ImageSelection.css';\n\nfunction prevent(event) {\n    event.stopPropagation();\n    event.preventDefault();\n}\n\nfunction onDragEnterOrOver(event) {\n    prevent(event);\n    event.currentTarget.classList.add('highlight');\n}\n\nfunction onDrop(image) {\n    const reader = new FileReader();\n    reader.onloadend = function() {\n        image.src = reader.result;\n    };\n\n    return event => {\n        prevent(event);\n        reader.readAsDataURL(event.dataTransfer.files[0]);\n    };\n}\n\nfunction onDragLeave(event) {\n    prevent(event);\n    event.currentTarget.classList.remove('highlight');\n}\n\nfunction onImageLoad(callback) {\n    return event => {\n        const image = event.target;\n        callback(image);\n        URL.revokeObjectURL(image.src);\n        image.src = null;\n    };\n}\n\nfunction onFileChange(image) {\n    return event => {\n        const file = event.target.files[0];\n        file && (image.src = URL.createObjectURL(file));\n    };\n}\n\nfunction ImageSelection(props) {\n    const image = new Image();\n    image.onload = onImageLoad(props.onChange);\n\n    return (\n        <div\n            class=\"drop-target\"\n            onDragEnter={onDragEnterOrOver}\n            onDragOver={onDragEnterOrOver}\n            onDrop={onDrop(image)}\n            onDragLeave={onDragLeave}\n        >\n            Drag &amp; drop or{' '}\n            <label>\n                click here to select\n                <input\n                    id=\"file\"\n                    type=\"file\"\n                    onChange={onFileChange(image)}\n                    accept=\"image/*\"\n                    hidden\n                />\n            </label>{' '}\n            an image\n        </div>\n    );\n}\n\nexport default pure(ImageSelection);\n","import { h, Component } from 'preact';\nimport { pure, shallowDiffers } from '../../util/pure-component.js';\n\nfunction putImageData(canvas, imageData) {\n    const context = canvas.getContext('2d');\n\n    if (imageData) {\n        if (canvas.width !== imageData.width) {\n            canvas.width = imageData.width;\n        }\n        if (canvas.height !== imageData.height) {\n            canvas.height = imageData.height; // this flash canvas\n        }\n\n        context.putImageData(imageData, 0, 0);\n    }\n}\n\nconst Dom = pure(function CanvasDom(props) {\n    return (\n        <canvas\n            ref={props.getRef}\n            style={{\n                maxWidth: '100%',\n                height: 'auto',\n            }}\n        />\n    );\n});\n\nexport default class Canvas extends Component {\n    constructor(props) {\n        super(props);\n        this.getRef = dom => (this.el = dom);\n    }\n\n    shouldComponentUpdate(props) {\n        return shallowDiffers(this.props, props);\n    }\n\n    render() {\n        return <Dom getRef={this.getRef} />;\n    }\n\n    componentDidMount() {\n        putImageData(this.el, this.props.image);\n    }\n\n    componentDidUpdate() {\n        putImageData(this.el, this.props.image);\n    }\n}\n","import { h } from 'preact';\nimport { pure } from '../../util/pure-component';\nimport Canvas from './Canvas';\nimport './Filters.css';\n\nfunction Button(props) {\n    const filter = props.filter;\n\n    if (filter.thumbnail === undefined) {\n        return null;\n    }\n\n    return (\n        <button\n            class={props.selected && 'selected'}\n            onClick={() => props.onSelect(filter.fn)}\n        >\n            <span>{filter.label}</span>\n            <Canvas image={filter.thumbnail} filter={filter.fn} />\n        </button>\n    );\n}\n\nconst PureButton = pure(Button);\n\nfunction Filters(props) {\n    return (\n        <div class=\"filters\">\n            {props.filters.map(filter => (\n                <PureButton\n                    key={filter.fn}\n                    filter={filter}\n                    selected={filter.fn === props.selected}\n                    onSelect={props.onSelect}\n                />\n            ))}\n        </div>\n    );\n}\n\nconst PureFilters = pure(Filters);\n\nexport default pure(function(props) {\n    const filters = props.filters;\n    return filters.length === 0 ? null : (\n        <PureFilters\n            filters={filters}\n            selected={props.selected}\n            onSelect={props.onSelect}\n        />\n    );\n});\n","/* global window */\nimport ponyfill from './ponyfill.js';\n\nvar root;\n\nif (typeof self !== 'undefined') {\n  root = self;\n} else if (typeof window !== 'undefined') {\n  root = window;\n} else if (typeof global !== 'undefined') {\n  root = global;\n} else if (typeof module !== 'undefined') {\n  root = module;\n} else {\n  root = Function('return this')();\n}\n\nvar result = ponyfill(root);\nexport default result;\n","export default function symbolObservablePonyfill(root) {\n\tvar result;\n\tvar Symbol = root.Symbol;\n\n\tif (typeof Symbol === 'function') {\n\t\tif (Symbol.observable) {\n\t\t\tresult = Symbol.observable;\n\t\t} else {\n\t\t\tresult = Symbol('observable');\n\t\t\tSymbol.observable = result;\n\t\t}\n\t} else {\n\t\tresult = '@@observable';\n\t}\n\n\treturn result;\n};\n","import $$observable from 'symbol-observable';\n\n/**\n * These are private action types reserved by Redux.\n * For any unknown actions, you must return the current state.\n * If the current state is undefined, you must return the initial state.\n * Do not reference these action types directly in your code.\n */\nvar randomString = function randomString() {\n  return Math.random().toString(36).substring(7).split('').join('.');\n};\n\nvar ActionTypes = {\n  INIT: \"@@redux/INIT\" + randomString(),\n  REPLACE: \"@@redux/REPLACE\" + randomString(),\n  PROBE_UNKNOWN_ACTION: function PROBE_UNKNOWN_ACTION() {\n    return \"@@redux/PROBE_UNKNOWN_ACTION\" + randomString();\n  }\n};\n\n/**\n * @param {any} obj The object to inspect.\n * @returns {boolean} True if the argument appears to be a plain object.\n */\nfunction isPlainObject(obj) {\n  if (typeof obj !== 'object' || obj === null) return false;\n  var proto = obj;\n\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return Object.getPrototypeOf(obj) === proto;\n}\n\n/**\n * Creates a Redux store that holds the state tree.\n * The only way to change the data in the store is to call `dispatch()` on it.\n *\n * There should only be a single store in your app. To specify how different\n * parts of the state tree respond to actions, you may combine several reducers\n * into a single reducer function by using `combineReducers`.\n *\n * @param {Function} reducer A function that returns the next state tree, given\n * the current state tree and the action to handle.\n *\n * @param {any} [preloadedState] The initial state. You may optionally specify it\n * to hydrate the state from the server in universal apps, or to restore a\n * previously serialized user session.\n * If you use `combineReducers` to produce the root reducer function, this must be\n * an object with the same shape as `combineReducers` keys.\n *\n * @param {Function} [enhancer] The store enhancer. You may optionally specify it\n * to enhance the store with third-party capabilities such as middleware,\n * time travel, persistence, etc. The only store enhancer that ships with Redux\n * is `applyMiddleware()`.\n *\n * @returns {Store} A Redux store that lets you read the state, dispatch actions\n * and subscribe to changes.\n */\n\nfunction createStore(reducer, preloadedState, enhancer) {\n  var _ref2;\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'function' || typeof enhancer === 'function' && typeof arguments[3] === 'function') {\n    throw new Error('It looks like you are passing several store enhancers to ' + 'createStore(). This is not supported. Instead, compose them ' + 'together to a single function');\n  }\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'undefined') {\n    enhancer = preloadedState;\n    preloadedState = undefined;\n  }\n\n  if (typeof enhancer !== 'undefined') {\n    if (typeof enhancer !== 'function') {\n      throw new Error('Expected the enhancer to be a function.');\n    }\n\n    return enhancer(createStore)(reducer, preloadedState);\n  }\n\n  if (typeof reducer !== 'function') {\n    throw new Error('Expected the reducer to be a function.');\n  }\n\n  var currentReducer = reducer;\n  var currentState = preloadedState;\n  var currentListeners = [];\n  var nextListeners = currentListeners;\n  var isDispatching = false;\n\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice();\n    }\n  }\n  /**\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n\n\n  function getState() {\n    if (isDispatching) {\n      throw new Error('You may not call store.getState() while the reducer is executing. ' + 'The reducer has already received the state as an argument. ' + 'Pass it down from the top reducer instead of reading it from the store.');\n    }\n\n    return currentState;\n  }\n  /**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   *\n   * You may call `dispatch()` from a change listener, with the following\n   * caveats:\n   *\n   * 1. The subscriptions are snapshotted just before every `dispatch()` call.\n   * If you subscribe or unsubscribe while the listeners are being invoked, this\n   * will not have any effect on the `dispatch()` that is currently in progress.\n   * However, the next `dispatch()` call, whether nested or not, will use a more\n   * recent snapshot of the subscription list.\n   *\n   * 2. The listener should not expect to see all state changes, as the state\n   * might have been updated multiple times during a nested `dispatch()` before\n   * the listener is called. It is, however, guaranteed that all subscribers\n   * registered before the `dispatch()` started will be called with the latest\n   * state by the time it exits.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n\n\n  function subscribe(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error('Expected the listener to be a function.');\n    }\n\n    if (isDispatching) {\n      throw new Error('You may not call store.subscribe() while the reducer is executing. ' + 'If you would like to be notified after the store has been updated, subscribe from a ' + 'component and invoke store.getState() in the callback to access the latest state. ' + 'See https://redux.js.org/api-reference/store#subscribe(listener) for more details.');\n    }\n\n    var isSubscribed = true;\n    ensureCanMutateNextListeners();\n    nextListeners.push(listener);\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n\n      if (isDispatching) {\n        throw new Error('You may not unsubscribe from a store listener while the reducer is executing. ' + 'See https://redux.js.org/api-reference/store#subscribe(listener) for more details.');\n      }\n\n      isSubscribed = false;\n      ensureCanMutateNextListeners();\n      var index = nextListeners.indexOf(listener);\n      nextListeners.splice(index, 1);\n    };\n  }\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing “what changed”. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n\n\n  function dispatch(action) {\n    if (!isPlainObject(action)) {\n      throw new Error('Actions must be plain objects. ' + 'Use custom middleware for async actions.');\n    }\n\n    if (typeof action.type === 'undefined') {\n      throw new Error('Actions may not have an undefined \"type\" property. ' + 'Have you misspelled a constant?');\n    }\n\n    if (isDispatching) {\n      throw new Error('Reducers may not dispatch actions.');\n    }\n\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action);\n    } finally {\n      isDispatching = false;\n    }\n\n    var listeners = currentListeners = nextListeners;\n\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      listener();\n    }\n\n    return action;\n  }\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n\n\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== 'function') {\n      throw new Error('Expected the nextReducer to be a function.');\n    }\n\n    currentReducer = nextReducer;\n    dispatch({\n      type: ActionTypes.REPLACE\n    });\n  }\n  /**\n   * Interoperability point for observable/reactive libraries.\n   * @returns {observable} A minimal observable of state changes.\n   * For more information, see the observable proposal:\n   * https://github.com/tc39/proposal-observable\n   */\n\n\n  function observable() {\n    var _ref;\n\n    var outerSubscribe = subscribe;\n    return _ref = {\n      /**\n       * The minimal observable subscription method.\n       * @param {Object} observer Any object that can be used as an observer.\n       * The observer object should have a `next` method.\n       * @returns {subscription} An object with an `unsubscribe` method that can\n       * be used to unsubscribe the observable from the store, and prevent further\n       * emission of values from the observable.\n       */\n      subscribe: function subscribe(observer) {\n        if (typeof observer !== 'object' || observer === null) {\n          throw new TypeError('Expected the observer to be an object.');\n        }\n\n        function observeState() {\n          if (observer.next) {\n            observer.next(getState());\n          }\n        }\n\n        observeState();\n        var unsubscribe = outerSubscribe(observeState);\n        return {\n          unsubscribe: unsubscribe\n        };\n      }\n    }, _ref[$$observable] = function () {\n      return this;\n    }, _ref;\n  } // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n\n\n  dispatch({\n    type: ActionTypes.INIT\n  });\n  return _ref2 = {\n    dispatch: dispatch,\n    subscribe: subscribe,\n    getState: getState,\n    replaceReducer: replaceReducer\n  }, _ref2[$$observable] = observable, _ref2;\n}\n\n/**\n * Prints a warning in the console if it exists.\n *\n * @param {String} message The warning message.\n * @returns {void}\n */\nfunction warning(message) {\n  /* eslint-disable no-console */\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    console.error(message);\n  }\n  /* eslint-enable no-console */\n\n\n  try {\n    // This error was thrown as a convenience so that if you enable\n    // \"break on all exceptions\" in your console,\n    // it would pause the execution at this line.\n    throw new Error(message);\n  } catch (e) {} // eslint-disable-line no-empty\n\n}\n\nfunction getUndefinedStateErrorMessage(key, action) {\n  var actionType = action && action.type;\n  var actionDescription = actionType && \"action \\\"\" + String(actionType) + \"\\\"\" || 'an action';\n  return \"Given \" + actionDescription + \", reducer \\\"\" + key + \"\\\" returned undefined. \" + \"To ignore an action, you must explicitly return the previous state. \" + \"If you want this reducer to hold no value, you can return null instead of undefined.\";\n}\n\nfunction getUnexpectedStateShapeWarningMessage(inputState, reducers, action, unexpectedKeyCache) {\n  var reducerKeys = Object.keys(reducers);\n  var argumentName = action && action.type === ActionTypes.INIT ? 'preloadedState argument passed to createStore' : 'previous state received by the reducer';\n\n  if (reducerKeys.length === 0) {\n    return 'Store does not have a valid reducer. Make sure the argument passed ' + 'to combineReducers is an object whose values are reducers.';\n  }\n\n  if (!isPlainObject(inputState)) {\n    return \"The \" + argumentName + \" has unexpected type of \\\"\" + {}.toString.call(inputState).match(/\\s([a-z|A-Z]+)/)[1] + \"\\\". Expected argument to be an object with the following \" + (\"keys: \\\"\" + reducerKeys.join('\", \"') + \"\\\"\");\n  }\n\n  var unexpectedKeys = Object.keys(inputState).filter(function (key) {\n    return !reducers.hasOwnProperty(key) && !unexpectedKeyCache[key];\n  });\n  unexpectedKeys.forEach(function (key) {\n    unexpectedKeyCache[key] = true;\n  });\n  if (action && action.type === ActionTypes.REPLACE) return;\n\n  if (unexpectedKeys.length > 0) {\n    return \"Unexpected \" + (unexpectedKeys.length > 1 ? 'keys' : 'key') + \" \" + (\"\\\"\" + unexpectedKeys.join('\", \"') + \"\\\" found in \" + argumentName + \". \") + \"Expected to find one of the known reducer keys instead: \" + (\"\\\"\" + reducerKeys.join('\", \"') + \"\\\". Unexpected keys will be ignored.\");\n  }\n}\n\nfunction assertReducerShape(reducers) {\n  Object.keys(reducers).forEach(function (key) {\n    var reducer = reducers[key];\n    var initialState = reducer(undefined, {\n      type: ActionTypes.INIT\n    });\n\n    if (typeof initialState === 'undefined') {\n      throw new Error(\"Reducer \\\"\" + key + \"\\\" returned undefined during initialization. \" + \"If the state passed to the reducer is undefined, you must \" + \"explicitly return the initial state. The initial state may \" + \"not be undefined. If you don't want to set a value for this reducer, \" + \"you can use null instead of undefined.\");\n    }\n\n    if (typeof reducer(undefined, {\n      type: ActionTypes.PROBE_UNKNOWN_ACTION()\n    }) === 'undefined') {\n      throw new Error(\"Reducer \\\"\" + key + \"\\\" returned undefined when probed with a random type. \" + (\"Don't try to handle \" + ActionTypes.INIT + \" or other actions in \\\"redux/*\\\" \") + \"namespace. They are considered private. Instead, you must return the \" + \"current state for any unknown actions, unless it is undefined, \" + \"in which case you must return the initial state, regardless of the \" + \"action type. The initial state may not be undefined, but can be null.\");\n    }\n  });\n}\n/**\n * Turns an object whose values are different reducer functions, into a single\n * reducer function. It will call every child reducer, and gather their results\n * into a single state object, whose keys correspond to the keys of the passed\n * reducer functions.\n *\n * @param {Object} reducers An object whose values correspond to different\n * reducer functions that need to be combined into one. One handy way to obtain\n * it is to use ES6 `import * as reducers` syntax. The reducers may never return\n * undefined for any action. Instead, they should return their initial state\n * if the state passed to them was undefined, and the current state for any\n * unrecognized action.\n *\n * @returns {Function} A reducer function that invokes every reducer inside the\n * passed object, and builds a state object with the same shape.\n */\n\n\nfunction combineReducers(reducers) {\n  var reducerKeys = Object.keys(reducers);\n  var finalReducers = {};\n\n  for (var i = 0; i < reducerKeys.length; i++) {\n    var key = reducerKeys[i];\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof reducers[key] === 'undefined') {\n        warning(\"No reducer provided for key \\\"\" + key + \"\\\"\");\n      }\n    }\n\n    if (typeof reducers[key] === 'function') {\n      finalReducers[key] = reducers[key];\n    }\n  }\n\n  var finalReducerKeys = Object.keys(finalReducers);\n  var unexpectedKeyCache;\n\n  if (process.env.NODE_ENV !== 'production') {\n    unexpectedKeyCache = {};\n  }\n\n  var shapeAssertionError;\n\n  try {\n    assertReducerShape(finalReducers);\n  } catch (e) {\n    shapeAssertionError = e;\n  }\n\n  return function combination(state, action) {\n    if (state === void 0) {\n      state = {};\n    }\n\n    if (shapeAssertionError) {\n      throw shapeAssertionError;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      var warningMessage = getUnexpectedStateShapeWarningMessage(state, finalReducers, action, unexpectedKeyCache);\n\n      if (warningMessage) {\n        warning(warningMessage);\n      }\n    }\n\n    var hasChanged = false;\n    var nextState = {};\n\n    for (var _i = 0; _i < finalReducerKeys.length; _i++) {\n      var _key = finalReducerKeys[_i];\n      var reducer = finalReducers[_key];\n      var previousStateForKey = state[_key];\n      var nextStateForKey = reducer(previousStateForKey, action);\n\n      if (typeof nextStateForKey === 'undefined') {\n        var errorMessage = getUndefinedStateErrorMessage(_key, action);\n        throw new Error(errorMessage);\n      }\n\n      nextState[_key] = nextStateForKey;\n      hasChanged = hasChanged || nextStateForKey !== previousStateForKey;\n    }\n\n    return hasChanged ? nextState : state;\n  };\n}\n\nfunction bindActionCreator(actionCreator, dispatch) {\n  return function () {\n    return dispatch(actionCreator.apply(this, arguments));\n  };\n}\n/**\n * Turns an object whose values are action creators, into an object with the\n * same keys, but with every function wrapped into a `dispatch` call so they\n * may be invoked directly. This is just a convenience method, as you can call\n * `store.dispatch(MyActionCreators.doSomething())` yourself just fine.\n *\n * For convenience, you can also pass a single function as the first argument,\n * and get a function in return.\n *\n * @param {Function|Object} actionCreators An object whose values are action\n * creator functions. One handy way to obtain it is to use ES6 `import * as`\n * syntax. You may also pass a single function.\n *\n * @param {Function} dispatch The `dispatch` function available on your Redux\n * store.\n *\n * @returns {Function|Object} The object mimicking the original object, but with\n * every action creator wrapped into the `dispatch` call. If you passed a\n * function as `actionCreators`, the return value will also be a single\n * function.\n */\n\n\nfunction bindActionCreators(actionCreators, dispatch) {\n  if (typeof actionCreators === 'function') {\n    return bindActionCreator(actionCreators, dispatch);\n  }\n\n  if (typeof actionCreators !== 'object' || actionCreators === null) {\n    throw new Error(\"bindActionCreators expected an object or a function, instead received \" + (actionCreators === null ? 'null' : typeof actionCreators) + \". \" + \"Did you write \\\"import ActionCreators from\\\" instead of \\\"import * as ActionCreators from\\\"?\");\n  }\n\n  var keys = Object.keys(actionCreators);\n  var boundActionCreators = {};\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var actionCreator = actionCreators[key];\n\n    if (typeof actionCreator === 'function') {\n      boundActionCreators[key] = bindActionCreator(actionCreator, dispatch);\n    }\n  }\n\n  return boundActionCreators;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\n/**\n * Composes single-argument functions from right to left. The rightmost\n * function can take multiple arguments as it provides the signature for\n * the resulting composite function.\n *\n * @param {...Function} funcs The functions to compose.\n * @returns {Function} A function obtained by composing the argument functions\n * from right to left. For example, compose(f, g, h) is identical to doing\n * (...args) => f(g(h(...args))).\n */\nfunction compose() {\n  for (var _len = arguments.length, funcs = new Array(_len), _key = 0; _key < _len; _key++) {\n    funcs[_key] = arguments[_key];\n  }\n\n  if (funcs.length === 0) {\n    return function (arg) {\n      return arg;\n    };\n  }\n\n  if (funcs.length === 1) {\n    return funcs[0];\n  }\n\n  return funcs.reduce(function (a, b) {\n    return function () {\n      return a(b.apply(void 0, arguments));\n    };\n  });\n}\n\n/**\n * Creates a store enhancer that applies middleware to the dispatch method\n * of the Redux store. This is handy for a variety of tasks, such as expressing\n * asynchronous actions in a concise manner, or logging every action payload.\n *\n * See `redux-thunk` package as an example of the Redux middleware.\n *\n * Because middleware is potentially asynchronous, this should be the first\n * store enhancer in the composition chain.\n *\n * Note that each middleware will be given the `dispatch` and `getState` functions\n * as named arguments.\n *\n * @param {...Function} middlewares The middleware chain to be applied.\n * @returns {Function} A store enhancer applying the middleware.\n */\n\nfunction applyMiddleware() {\n  for (var _len = arguments.length, middlewares = new Array(_len), _key = 0; _key < _len; _key++) {\n    middlewares[_key] = arguments[_key];\n  }\n\n  return function (createStore) {\n    return function () {\n      var store = createStore.apply(void 0, arguments);\n\n      var _dispatch = function dispatch() {\n        throw new Error(\"Dispatching while constructing your middleware is not allowed. \" + \"Other middleware would not be applied to this dispatch.\");\n      };\n\n      var middlewareAPI = {\n        getState: store.getState,\n        dispatch: function dispatch() {\n          return _dispatch.apply(void 0, arguments);\n        }\n      };\n      var chain = middlewares.map(function (middleware) {\n        return middleware(middlewareAPI);\n      });\n      _dispatch = compose.apply(void 0, chain)(store.dispatch);\n      return _objectSpread({}, store, {\n        dispatch: _dispatch\n      });\n    };\n  };\n}\n\n/*\n * This is a dummy function to check if the function name has been altered by minification.\n * If the function has been minified and NODE_ENV !== 'production', warn the user.\n */\n\nfunction isCrushed() {}\n\nif (process.env.NODE_ENV !== 'production' && typeof isCrushed.name === 'string' && isCrushed.name !== 'isCrushed') {\n  warning('You are currently using minified code outside of NODE_ENV === \"production\". ' + 'This means that you are running a slower development build of Redux. ' + 'You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify ' + 'or setting mode to production in webpack (https://webpack.js.org/concepts/mode/) ' + 'to ensure you have the correct code for your production build.');\n}\n\nexport { createStore, combineReducers, bindActionCreators, applyMiddleware, compose, ActionTypes as __DO_NOT_USE__ActionTypes };\n","export default function getImageData(image, dWidth, dHeight) {\n    const canvas = document.createElement('canvas');\n    const context = canvas.getContext('2d');\n    const sWidth = image.width;\n    const sHeight = image.height;\n\n    dWidth = dWidth === undefined ? sWidth : dWidth;\n    dHeight = dHeight === undefined ? sHeight : dHeight;\n    canvas.width = dWidth;\n    canvas.height = dHeight;\n    context.drawImage(image, 0, 0, sWidth, sHeight, 0, 0, dWidth, dHeight);\n\n    return context.getImageData(0, 0, dWidth, dHeight);\n}\n","import getImageData from '../../../util/image-data';\n\nconst THUMBNAIL_SIZE = 100;\n\nexport function createThumbnail(img) {\n    return getImageData(\n        img,\n        Math.round((img.width * THUMBNAIL_SIZE) / img.height),\n        THUMBNAIL_SIZE\n    );\n}\n\nexport default function imageReducer(state, img) {\n    const image = getImageData(img);\n    const thumbnail = createThumbnail(img);\n\n    return Object.assign({}, state, {\n        image,\n        thumbnail,\n        filter: 'ORIGINAL',\n        filters: state.filters.map(filter =>\n            Object.assign({}, filter, {\n                thumbnail,\n            })\n        ),\n        filteredImage: image,\n    });\n}\n","const myWorker = new Worker('dist/web-worker.js');\nconst requests = {};\n\nmyWorker.onmessage = function(event) {\n    const data = event.data;\n    const timestamp = Array.isArray(data) ? data[4] : -1;\n    const promise = requests[timestamp];\n    if (promise !== undefined) {\n        promise.resolve(data[0]);\n        delete requests[timestamp];\n    }\n};\n\nmyWorker.onerror = function(event) {\n    // no idea\n};\n\nexport function requestImageFilter(options) {\n    const { image, filter, color, threshold } = options;\n    return new Promise(function(resolve, reject) {\n        const timestamp = filter + '_' + performance.now() + Math.random();\n        requests[timestamp] = {\n            resolve,\n            reject,\n        };\n        myWorker.postMessage([image, filter, color, threshold, timestamp]);\n    });\n}\n","// seperate file to avoid circular reference\n\nexport const FILTER_CHANGE = 'FILTER_CHANGE';\nexport const IMAGE_CHANGE = 'IMAGE_CHANGE';\nexport const IMAGE_FILTER_DONE = 'IMAGE_FILTER_DONE';\nexport const THUMBNAIL_FILTER_DONE = 'THUMBNAIL_FILTER_DONE';\n","import { createStore, applyMiddleware } from 'redux';\nimport filters from '../../util/filters';\nimport imageChangeReducer from './reducers/image-change';\nimport middleware from './reducers/middleware';\n\nimport {\n    FILTER_CHANGE,\n    IMAGE_CHANGE,\n    IMAGE_FILTER_DONE,\n    THUMBNAIL_FILTER_DONE,\n} from './constants';\n\nconst defaultState = {\n    image: null,\n    filteredImage: null,\n    thumbnail: null,\n    filter: 'ORIGINAL',\n    filters,\n};\n\nconst app = function(state = defaultState, action) {\n    const data = action.data;\n\n    switch (action.type) {\n        case FILTER_CHANGE:\n            return Object.assign({}, state, {\n                filter: data,\n            });\n        case IMAGE_CHANGE:\n            return imageChangeReducer(state, data);\n        case IMAGE_FILTER_DONE:\n            return Object.assign({}, state, {\n                filteredImage: data,\n            });\n        case THUMBNAIL_FILTER_DONE:\n            return Object.assign({}, state, {\n                filters: data,\n            });\n    }\n\n    return state;\n};\n\nexport default createStore(app, applyMiddleware(middleware));\n","export default [\n    {\n        label: 'Original',\n        fn: 'ORIGINAL',\n    },\n    {\n        label: 'Invert',\n        fn: 'INVERT',\n    },\n    {\n        label: 'Grayscale',\n        fn: 'GRAYSCALE',\n    },\n    {\n        label: 'Red Tone',\n        fn: 'RED_TONE',\n    },\n    {\n        label: 'Red',\n        fn: 'RED',\n    },\n    {\n        label: 'Green Tone',\n        fn: 'GREEN_TONE',\n    },\n    {\n        label: 'Green',\n        fn: 'GREEN',\n    },\n    {\n        label: 'Blue Tone',\n        fn: 'BLUE_TONE',\n    },\n    {\n        label: 'Blue',\n        fn: 'BLUE',\n    },\n    {\n        label: 'Hue',\n        fn: 'HUE',\n    },\n    {\n        label: 'Saturation',\n        fn: 'SATURATION',\n    },\n    {\n        label: 'Lightness',\n        fn: 'LIGHTNESS',\n    },\n];\n","import { requestImageFilter } from '../../../util/worker';\nimport { createThumbnail } from './image-change';\nimport {\n    IMAGE_CHANGE,\n    THUMBNAIL_FILTER_DONE,\n    FILTER_CHANGE,\n    IMAGE_FILTER_DONE,\n} from './../constants';\n\nexport default store => next => action => {\n    const state = store.getState();\n    const data = action.data;\n    let image;\n    switch (action.type) {\n        case IMAGE_CHANGE:\n            image = createThumbnail(data);\n            Promise.all(\n                state.filters.map(filter =>\n                    requestImageFilter({\n                        filter: filter.fn,\n                        image,\n                    })\n                )\n            ).then(function(data) {\n                next({\n                    type: THUMBNAIL_FILTER_DONE,\n                    data: state.filters.map((filter, index) => {\n                        return Object.assign({}, filter, {\n                            thumbnail: data[index],\n                        });\n                    }),\n                });\n            });\n            break;\n        case FILTER_CHANGE:\n            state.filter !== data &&\n                setTimeout(function() {\n                    requestImageFilter({\n                        filter: data,\n                        image: state.image,\n                    }).then(data =>\n                        next({\n                            type: IMAGE_FILTER_DONE,\n                            data,\n                        })\n                    );\n                });\n    }\n\n    next(action);\n};\n","import { h, Component } from 'preact';\nimport ImageSelection from './ImageSelection';\nimport Canvas from './Canvas';\nimport Filters from './Filters';\nimport store from '../store/main';\nimport { IMAGE_CHANGE, FILTER_CHANGE } from '../store/constants';\nimport './Application.css';\n\nexport default class Application extends Component {\n    constructor(props) {\n        super(props);\n        this.state = store.getState();\n    }\n\n    componentDidMount() {\n        store.subscribe(() => this.setState(store.getState()));\n    }\n\n    onImageChange(image) {\n        store.dispatch({\n            type: IMAGE_CHANGE,\n            data: image,\n        });\n    }\n\n    onFilterChange(filter) {\n        store.dispatch({\n            type: FILTER_CHANGE,\n            data: filter,\n        });\n    }\n\n    render(props, state) {\n        return (\n            <main>\n                <ImageSelection onChange={this.onImageChange} />\n                <Canvas image={state.filteredImage} />\n                <Filters\n                    filters={state.filters}\n                    selected={state.filter}\n                    onSelect={this.onFilterChange}\n                />\n            </main>\n        );\n    }\n}\n","import '../util/object-assign.js';\nimport { h, render } from 'preact';\nimport Application from './components/Application.jsx';\n\nrender(<Application />, document.getElementById('root'));\n"],"names":["Object","assign","defineProperty","value","target","varArgs","TypeError","to","index","arguments","length","nextSource","nextKey","prototype","hasOwnProperty","call","writable","configurable","l","n","u","i","r","f","e","o","t","push","children","defaultProps","ref","key","c","type","props","text","__k","__e","__c","vnode","a","h","Array","isArray","v","this","context","y","__d","debounceRendering","p","pop","forceUpdate","d","s","b","g","w","k","x","A","m","C","N","T","nextSibling","_","document","activeElement","parentNode","appendChild","insertBefore","focus","remove","P","style","cssText","setProperty","replace","test","__html","innerHTML","toLowerCase","substring","addEventListener","removeEventListener","removeAttribute","setAttribute","event","$","j","z","D","H","I","L","diff","contextType","__p","render","constructor","__a","sub","state","__n","__h","__v","__s","getDerivedStateFromProps","componentWillMount","componentDidMount","shouldComponentUpdate","componentWillReceiveProps","componentWillUpdate","__t","getChildContext","getSnapshotBeforeUpdate","base","componentDidUpdate","diffed","commit","nodeType","localName","createTextNode","createElementNS","createElement","data","childNodes","slice","attributes","name","current","unmount","componentWillUnmount","getDerivedStateFromError","setState","componentDidCatch","pure","__scuWrap","fn","Wrap","Wrapper","renderChild","ownerSVGElement","Promise","resolve","then","bind","setTimeout","shallowDiffers","Component","let","prevent","stopPropagation","preventDefault","onDragEnterOrOver","currentTarget","classList","add","onDrop","image","const","reader","FileReader","onloadend","src","result","readAsDataURL","dataTransfer","files","onDragLeave","onFileChange","file","URL","createObjectURL","callback","Image","onload","onChange","revokeObjectURL","class","onDragEnter","onDragOver","id","accept","hidden","putImageData","canvas","imageData","getContext","width","height","Dom","getRef","maxWidth","Canvas","super","dom","el","PureButton","filter","undefined","thumbnail","selected","onClick","onSelect","label","PureFilters","filters","map","root","Symbol","observable","ponyfill","self","window","global","module","Function","randomString","Math","random","toString","split","join","ActionTypes","INIT","REPLACE","PROBE_UNKNOWN_ACTION","_defineProperty","obj","enumerable","getImageData","dWidth","dHeight","sWidth","sHeight","drawImage","THUMBNAIL_SIZE","createThumbnail","img","round","myWorker","Worker","requests","requestImageFilter","options","reject","timestamp","performance","now","postMessage","color","threshold","onmessage","promise","onerror","FILTER_CHANGE","IMAGE_CHANGE","IMAGE_FILTER_DONE","THUMBNAIL_FILTER_DONE","defaultState","filteredImage","createStore","reducer","preloadedState","enhancer","_ref2","Error","currentReducer","currentState","currentListeners","nextListeners","isDispatching","ensureCanMutateNextListeners","getState","subscribe","listener","isSubscribed","indexOf","splice","dispatch","action","proto","getPrototypeOf","isPlainObject","listeners","replaceReducer","nextReducer","$$observable","_ref","outerSubscribe","observer","observeState","next","unsubscribe","imageChangeReducer","_len","middlewares","_key","store","apply","_dispatch","middlewareAPI","chain","middleware","source","ownKeys","keys","getOwnPropertySymbols","concat","sym","getOwnPropertyDescriptor","forEach","_objectSpread","funcs","arg","reduce","compose","applyMiddleware","all","Application","onImageChange","onFilterChange","ImageSelection","Filters","getElementById"],"mappings":"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"}