"use strict";var THRESHOLD=8;function invert(e){var r=0,n=e.length;for(r=0;r<n;r++)e[r]=(r+1)%4==0?e[r]:255-e[r];return e}function grayscale(e){var r,n,t=e.length;for(r=0;r<t;r+=4)n=(e[r]+e[r+1]+e[r+2])/3,e[r]=e[r+1]=e[r+2]=n;return e}function red(e){var r,n,t;for(n=0,t=e.length;n<t;n+=4)r=(e[n]+e[n+1]+e[n+2])/3,e[n]=e[n]>r?e[n]:r,e[n+1]=e[n+2]=r;return e}function red2(e){var r,n,t,a,c,o;for(c=0,o=e.length;c<o;c+=4)a=((r=e[c])+(n=e[c+1])+(t=e[c+2]))/3,(r<n+THRESHOLD||r<t+THRESHOLD)&&(e[c]=e[c+1]=e[c+2]=a);return e}function green(e){var r,n,t;for(n=0,t=e.length;n<t;n+=4)r=(e[n]+e[n+1]+e[n+2])/3,e[n+1]=e[n+1]>r?e[n+1]:r,e[n]=e[n+2]=r;return e}function green2(e){var r,n,t,a,c,o;for(c=0,o=e.length;c<o;c+=4)a=((r=e[c])+(n=e[c+1])+(t=e[c+2]))/3,(n<r+THRESHOLD||n<t+THRESHOLD)&&(e[c]=e[c+1]=e[c+2]=a);return e}function blue(e){var r,n,t;for(n=0,t=e.length;n<t;n+=4)r=(e[n]+e[n+1]+e[n+2])/3,e[n+2]<r&&(e[n]=e[n+1]=e[n+2]=r);return e}function blue2(e){var r,n,t,a,c,o;for(c=0,o=e.length;c<o;c+=4)a=((r=e[c])+(n=e[c+1])+(t=e[c+2]))/3,(t<r+THRESHOLD||t<n+THRESHOLD)&&(e[c]=e[c+1]=e[c+2]=a);return e}function distance3d(e,r,n){var t,a,c,o,u,s,i,g;for(o=0,u=e.length;o<u;o+=4){t=e[o],a=e[o+1],c=e[o+2],s=Math.pow(r[0]-t,2),i=Math.pow(r[1]-a,2),g=Math.pow(r[2]-c,2),Math.sqrt(2*s+4*i+3*g+(r[0]+t)*(s-g)/512)>n&&(e[o]=e[o+1]=e[o+2]=(t+a+c)/3)}return e}function hex2rgb(e){var r=(e||"#000000").toString().replace("#",""),n=r.length/3;return[0,1,2].map(function(e){var t=r.substr(e*n,n);return parseInt(1===n?t+t:t,16)})}onmessage=function(e){console.time("filter");var r=e.data,n=r[0].data,t=r[1],a=r[2],c=r[3];switch(t){case"invert":invert(n);break;case"grayscale":grayscale(n);break;case"red":red(n);break;case"red2":red2(n);break;case"green":green(n);break;case"green2":green2(n);break;case"blue":blue(n);break;case"blue2":blue2(n);break;case"distance3d":distance3d(n,hex2rgb(a),c)}console.timeEnd("filter"),postMessage(e.data)};
