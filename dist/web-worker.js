"use strict";function calculateHue(e,r,a){var t,n=e/255,s=r/255,c=a/255,u=Math.min(n,s,c),l=Math.max(n,s,c);if(u==l)t=0;else{var i=l-u;switch(l){case n:t=(s<c?6:0)+(s-c)/i;break;case s:t=2+(c-n)/i;break;case c:t=4+(n-s)/i}t=60*(t<0?360+t:t)}return t}function rgb2hsl(e,r,a){var t,n=e/255,s=r/255,c=a/255,u=Math.min(n,s,c),l=Math.max(n,s,c),i=(l+u)/2,h=0===l||1===u?0:(l-i)/Math.min(i,1-i);if(u==l)t=0;else{var o=l-u;switch(l){case n:t=(s<c?6:0)+(s-c)/o;break;case s:t=2+(c-n)/o;break;case c:t=4+(n-s)/o}t=60*(t<0?360+t:t)}return[t,h,i]}function invert(e){var r=0,a=e.length;for(r=0;r<a;r++)e[r]=(r+1)%4==0?e[r]:255-e[r];return e}function grayscale(e){for(var r=e.length,a=0;a<r;a+=4){var t=(e[a]+e[a+1]+e[a+2])/3;e[a]=e[a+1]=e[a+2]=t}return e}function red(e){var r,a,t;for(a=0,t=e.length;a<t;a+=4)r=(e[a]+e[a+1]+e[a+2])/3,e[a]=e[a]>r?e[a]:r,e[a+1]=e[a+2]=r;return e}function green(e){var r,a,t;for(a=0,t=e.length;a<t;a+=4)r=(e[a]+e[a+1]+e[a+2])/3,e[a+1]=e[a+1]>r?e[a+1]:r,e[a]=e[a+2]=r;return e}function blue(e){var r,a,t;for(a=0,t=e.length;a<t;a+=4)r=(e[a]+e[a+1]+e[a+2])/3,e[a+2]<r&&(e[a]=e[a+1]=e[a+2]=r);return e}function hue(e,r,a){for(var t=calculateHue(r[0],r[1],r[2]),n=(t-a+360)%360,s=(t+a+360)%360,c=n>s,u=0,l=e.length;u<l;u+=4){var i=e[u],h=e[u+1],o=e[u+2],g=calculateHue(i,h,o);(c?g<=n&&g>=s:g<n||g>s)&&(e[u]=e[u+1]=e[u+2]=(i+h+o)/3)}return e}function hsl2rgb(e,r,a){var t,n,s,c=2*a,u=(1-(c>1?c-1:1-c))*r,l=e/60%2,i=u*(1-(l>1?l-1:1-l)),h=a-u/2;return e>=0&&e<60?(t=u,n=i,s=0):e>=60&&e<120?(t=i,n=u,s=0):e>=120&&e<180?(t=0,n=u,s=i):e>=180&&e<240?(t=0,n=i,s=u):e>=240&&e<300?(t=i,n=0,s=u):e>=300&&e<360?(t=u,n=0,s=i):t=n=s=0,[255*(t+h),255*(n+h),255*(s+h)]}function saturation(e,r){for(var a=0,t=e.length;a<t;a+=4){var n=rgb2hsl(e[a],e[a+1],e[a+2]),s=n[1]+r,c=hsl2rgb(n[0],s>1?1:s<0?0:s,n[2]);e[a]=c[0],e[a+1]=c[1],e[a+2]=c[2]}return e}function lightness(e,r){for(var a=0,t=e.length;a<t;a+=4){var n=rgb2hsl(e[a],e[a+1],e[a+2]),s=n[2]+r,c=hsl2rgb(n[0],n[1],s>1?1:s<0?0:s);e[a]=c[0],e[a+1]=c[1],e[a+2]=c[2]}return e}function lightness$1(e,r){for(var a=0,t=e.length;a<t;a+=4){var n=rgb2hsl(e[a],e[a+1],e[a+2]),s=hsl2rgb((360+n[0]+r)%360,n[1],n[2]);e[a]=s[0],e[a+1]=s[1],e[a+2]=s[2]}return e}onmessage=function(e){console.time("filter");var r=e.data,a=r[0].data;switch(r[1]){case"INVERT":invert(a);break;case"GRAYSCALE":grayscale(a);break;case"RED_TONE":red(a);break;case"RED":hue(a,[255,0,0],60);break;case"GREEN_TONE":green(a);break;case"GREEN":hue(a,[0,255,0],60);break;case"BLUE_TONE":blue(a);break;case"BLUE":hue(a,[0,0,255],60);break;case"HUE":lightness$1(a,-30);break;case"SATURATION":saturation(a,.2);break;case"LIGHTNESS":lightness(a,.2)}postMessage(e.data),console.timeEnd("filter")};
