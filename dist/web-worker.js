"use strict";function calculateHue(e,a,r){var t,n=e/255,c=a/255,u=r/255,s=Math.min(n,c,u),l=Math.max(n,c,u);if(s==l)t=0;else{var o=l-s;switch(l){case n:t=(c<u?6:0)+(c-u)/o;break;case c:t=2+(u-n)/o;break;case u:t=4+(n-c)/o}t=60*(t<0?360+t:t)}return t}function invert(e){var a=0,r=e.length;for(a=0;a<r;a++)e[a]=(a+1)%4==0?e[a]:255-e[a];return e}function grayscale(e){for(var a=e.length,r=0;r<a;r+=4){var t=(e[r]+e[r+1]+e[r+2])/3;e[r]=e[r+1]=e[r+2]=t}return e}function red(e){var a,r,t;for(r=0,t=e.length;r<t;r+=4)a=(e[r]+e[r+1]+e[r+2])/3,e[r]=e[r]>a?e[r]:a,e[r+1]=e[r+2]=a;return e}function green(e){var a,r,t;for(r=0,t=e.length;r<t;r+=4)a=(e[r]+e[r+1]+e[r+2])/3,e[r+1]=e[r+1]>a?e[r+1]:a,e[r]=e[r+2]=a;return e}function blue(e){var a,r,t;for(r=0,t=e.length;r<t;r+=4)a=(e[r]+e[r+1]+e[r+2])/3,e[r+2]<a&&(e[r]=e[r+1]=e[r+2]=a);return e}function hue(e,a,r){for(var t=calculateHue(a[0],a[1],a[2]),n=(t-r+360)%360,c=(t+r+360)%360,u=n>c,s=0,l=e.length;s<l;s+=4){var o=e[s],i=e[s+1],f=e[s+2],h=calculateHue(o,i,f);(u?h<=n&&h>=c:h<n||h>c)&&(e[s]=e[s+1]=e[s+2]=(o+i+f)/3)}return e}onmessage=function(e){console.time("filter");var a=e.data,r=a[0].data;switch(a[1]){case"INVERT":invert(r);break;case"GRAYSCALE":grayscale(r);break;case"RED_TONE":red(r);break;case"RED":hue(r,[255,0,0],60);break;case"GREEN_TONE":green(r);break;case"GREEN":hue(r,[0,255,0],60);break;case"BLUE_TONE":blue(r);break;case"BLUE":hue(r,[0,0,255],60)}postMessage(e.data),console.timeEnd("filter")};
